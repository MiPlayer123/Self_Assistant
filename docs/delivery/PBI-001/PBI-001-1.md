# PBI-001-1: Wagoo UI Theme Implementation

**Parent Task List**: [Tasks for PBI-001](./tasks.md)

## Description

Implement comprehensive UI theme updates to transform the application into the Wagoo aesthetic. This includes window positioning at bottom-right, dark translucent theme with white text, unified CSS architecture, and consistent styling across all chat components.

## Status History

- **2024-12-19 20:35** - create_task - Proposed -> Proposed - Task created for Wagoo UI theme implementation - User
- **2024-12-19 20:40** - user_approves - Proposed -> Agreed - Task approved for implementation - User
- **2024-12-19 20:41** - start_work - Agreed -> InProgress - Implementation started - AI_Agent
- **2024-12-19 21:10** - submit_for_review - InProgress -> Review - Implementation completed, including fix for double message sending and avatar removal - AI_Agent
- **2024-12-19 21:20** - additional_fixes - Review -> Review - Fixed window resizing jankiness by disabling automatic dimension updates for chat view - AI_Agent
- **2024-12-19 21:30** - keybind_updates - Review -> Review - Updated keyboard shortcuts to use Ctrl on Mac (instead of Cmd), Alt on Windows/Linux, and disabled shortcuts when window is hidden - AI_Agent
- **2024-12-19 21:45** - final_keybind_updates - Review -> Review - Updated window movement commands to use Cmd on Mac while keeping others as Ctrl, created comprehensive keyboard shortcuts README - AI_Agent
- **2024-12-19 22:00** - streaming_implementation - Review -> Review - Implemented real-time streaming for LLM responses with visual indicators and improved user experience - AI_Agent
- **2024-12-19 22:15** - streaming_bug_fixes - Review -> Review - Fixed message targeting bug and persistent loading indicator issues in streaming implementation - AI_Agent
- **2024-12-19 22:30** - message_layout_improvements - Review -> Review - Enhanced chat message layout with wider bubbles, better spacing, and improved readability similar to ChatGPT - AI_Agent
- **2024-12-19 22:35** - dynamic_bubble_sizing - Review -> Review - Made message bubbles dynamically size to content - short messages get compact bubbles, long messages use available space - AI_Agent

## Requirements

### Window Configuration
- Position window at bottom-right corner of screen on startup
- Maintain proper resizability with existing minimum dimensions
- Preserve all existing window behavior and functionality

### UI Theme
- Implement dark translucent background (inspired by Interview Coders)
- Apply white text throughout the interface
- Ensure proper contrast ratios for accessibility
- Smooth animations and transitions

### CSS Architecture
- Create unified, modular CSS system
- Implement CSS custom properties for consistent theming
- Organize styles for maintainability and reusability
- Remove redundant or conflicting styles

### Component Updates
- Update all chat-related components for consistent styling
- Ensure proper theming of modals, messages, and interactive elements
- Maintain existing functionality while improving visual appeal
- Implement real-time streaming for LLM responses with visual feedback

## Implementation Plan

1. **Examine Current UI Structure**
   - Analyze all chat components and their current styling
   - Identify all files that need CSS updates
   - Document current window positioning logic

2. **Update Window Configuration**
   - Modify electron/main.ts to position window at bottom-right
   - Ensure proper screen boundary calculations
   - Test resizing functionality

3. **Create Unified CSS System**
   - Update src/index.css with comprehensive theme system
   - Implement CSS custom properties for colors, effects, and typography
   - Create modular classes for reusability

4. **Update Component Styling**
   - Apply new theme to all chat components
   - Ensure consistent styling across the application
   - Update any inline styles to use the unified system

5. **Testing and Validation**
   - Test all UI components for proper styling
   - Verify window positioning and resizing
   - Ensure no functionality regressions

## Test Plan

### Unit Testing
- TypeScript compilation successful
- No console errors during component rendering
- CSS classes properly applied to components

### Integration Testing
- Window positioning works correctly on startup
- Resizing functionality maintains proper behavior
- All chat components display with consistent theming
- Transitions and animations work smoothly

### Visual Testing
- Dark translucent background applied consistently
- White text readable with proper contrast
- No visual regressions or layout issues
- Professional Wagoo aesthetic achieved

## Verification

- [x] Window appears at bottom-right corner on startup
- [x] Window resizing works properly (resizable: true maintained)
- [x] Dark translucent theme applied consistently
- [x] White text used throughout interface
- [x] All chat components styled uniformly with Wagoo theme
- [x] CSS organized in modular structure with custom properties
- [x] No functionality regressions
- [x] Professional Interview Coders-inspired aesthetic achieved
- [x] Double message sending issue fixed
- [x] Avatar display removed from chat messages
- [x] All system messages converted to assistant messages
- [x] Window resizing jankiness fixed by disabling automatic dimension updates
- [x] Window position stability maintained during typing and user interactions
- [x] Keyboard shortcuts updated to use Ctrl on Mac (instead of Cmd) and Alt on Windows/Linux
- [x] Shortcuts disabled when window is hidden (except for window toggle)
- [x] Improved shortcut logging and visibility controls
- [x] Real-time streaming implemented for LLM responses
- [x] Visual streaming indicators added with animated dots
- [x] Enhanced user experience with immediate response feedback
- [x] Chat message layout improved with wider bubbles (85% vs 70% width)
- [x] Better horizontal space utilization similar to ChatGPT
- [x] Enhanced message spacing and readability with improved padding
- [x] Dynamic bubble sizing - short messages get compact bubbles, long messages expand up to 85% width
- [x] Improved visual hierarchy with content-appropriate sizing

## Files Modified

- **electron/main.ts** - Updated window positioning to bottom-right corner with proper margin calculations, disabled setWindowDimensions to prevent resizing interference
- **src/index.css** - Created comprehensive Wagoo theme with CSS custom properties, unified utility classes, and modular component styles
- **src/components/chat/ChatPage.tsx** - Updated to use Wagoo theme classes, fixed double message sending with useRef tracking, changed all system messages to assistant messages
- **src/components/chat/ChatMessage.tsx** - Updated to use Wagoo theme classes, removed avatar display logic
- **src/components/chat/ChatInput.tsx** - Updated to use Wagoo theme classes for inputs, buttons, and screenshot functionality
- **src/components/ui/toast.tsx** - Updated toast component to use Wagoo theme with proper dark translucent styling
- **src/_pages/SubscribedApp.tsx** - Disabled automatic dimension updates for chat view to prevent window resizing interference
- **electron/shortcuts.ts** - Updated keyboard shortcuts with platform-specific modifiers: Cmd for window movement on Mac, Ctrl for other actions on Mac, Alt for all actions on Windows/Linux, and added logic to disable shortcuts when window is hidden
- **KEYBOARD_SHORTCUTS.md** - Created comprehensive documentation of all keyboard shortcuts organized by function and platform
- **src/types/chat.ts** - Added 'streaming' status to ChatMessage interface for real-time response feedback
- **src/contexts/ChatContext.tsx** - Added appendToMessage action and handler for streaming message updates
- **src/models/base/ChatModel.ts** - Added sendMessageStream abstract method for streaming support
- **src/models/providers/openai/ChatModel.ts** - Implemented sendMessageStream with OpenAI streaming API integration
- **src/components/chat/ChatPage.tsx** - Updated message handling to use streaming with real-time chunk updates
- **src/components/chat/ChatMessage.tsx** - Added visual streaming indicators with animated dots 