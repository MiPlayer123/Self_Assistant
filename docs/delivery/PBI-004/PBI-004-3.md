# PBI-004-3: Enhanced Connection Error Screen

## Description
Update ConnectionErrorScreen with subscription-aware messaging that differentiates between free and paid users, providing appropriate upgrade prompts or offline access options.

## Status History
- **2025-01-03 18:25** - create_task - Proposed - Created task for enhanced connection error screen - AI_Agent
- **2025-01-03 18:25** - user_approves - Proposed -> Agreed - Task approved for implementation - User
- **2025-01-03 18:25** - start_work - Agreed -> InProgress - Starting enhanced connection error screen implementation - AI_Agent
- **2025-01-03 18:30** - submit_for_review - InProgress -> Review - Completed enhanced connection error screen with subscription-aware UI - AI_Agent

## Requirements
- Integrate useOfflineMode hook to detect subscription status
- Show different UI for free vs subscribed users when offline
- Free users: "Go online to use or upgrade for offline access"
- Subscribed users: "Continue Offline" button to proceed
- Maintain existing retry functionality
- Handle edge cases (expired subscriptions, no cache)

## Implementation Plan
1. Update `src/components/ConnectionErrorScreen.tsx`:
   - Import and use useOfflineMode hook
   - Add conditional rendering based on canUseOffline
   - Create "Continue Offline" button for subscribed users
   - Update messaging for different user types
   - Add upgrade button that opens subscription portal
2. Maintain existing retry logic and error handling

## Test Plan
**Objectives**: Verify subscription-aware UI and proper routing
**Scope**: Component testing with different subscription scenarios
**Environment**: Local development with simulated offline states
**Key Scenarios**:
- Free user offline experience
- Subscribed user offline experience
- Expired subscription handling
- Network retry functionality
**Success Criteria**: Correct UI displayed for each user type with proper functionality

## Verification
- [x] Free users see upgrade messaging when offline
- [x] Subscribed users can continue offline
- [x] Retry functionality preserved
- [x] Upgrade button opens subscription portal
- [x] Edge cases handled gracefully

## Files Modified
- `src/components/ConnectionErrorScreen.tsx` (updated) 